/*! simple-event-handler.js // @version 0.0.0, @license MIT, @Author dameleon <dameleon@gmail.com> */
!function(e){"use strict";function n(){if(p)throw new Error("SimpleEventHandler cannot use in node.js");var e=w.createElement("iframe");this.id=e.id="simple-event-handler-iframe"+W++,e.width=0,e.height=0,e.style.margin=0,e.style.padding=0,e.style.display="none",w.body.appendChild(e),this.iframeWindow=e.contentWindow,this.events={},this.iframeWindow.addEventListener("message",this)}function t(e,n){var t=this.getEvent(e),i=t.handlers;return f(i,n)>-1?!1:void(i[i.length]=g(n,!1))}function i(e,n){var t=this.getEvent(e);if(void 0===n)delete this.events[e];else{var i=t.handlers,r=f(i,n);r>-1&&i.splice(r,1)}}function r(e,n){var t=this.getEvent(e),i=t.handlers;return t.isCalled?(t.data||(t.data=document.createEvent(e)),u(n,t)):f(i,n)>-1?!1:void(i[i.length]=g(n,!0))}function a(e,n){var t=this.getEvent(e),i=t.handlers;return f(i,n)>-1?!1:void(i[i.length]=g(n,!0))}function o(e,n){var t;"string"==typeof e?(t=e,e=h(t)):t=e.type;var i=this.getEvent(t);n&&(e.data=n),i.data=e,this.iframeWindow.postMessage(t,H)}function s(e,n){var t;"string"==typeof e?(t=e,e=h(t)):t=e.type;var i=this.getEvent(t);n&&(e.data=n),i.data=e,this.callHandlers(t)}function d(e){var n,t,i=this.getEvent(e),r=i.handlers,a=i.data,o=[];for(i.isCalled=!0,n=0;t=r[n];n++)u(t.handler,a),t.isOnce&&(o[o.length]=t);for(i.data=null,n=0;t=o[n];n++){var s=r.indexOf(t);r.splice(s,1)}}function l(e){return this.events[e]||(this.events[e]={isCalled:!1,handlers:[],data:null})}function c(e){H===e.origin&&this.callHandlers(e.data)}function v(){return new n}function h(e){var n=document.createEvent("Event");return n.initEvent(e,!0,!0),n}function f(e,n){for(var t,i=0;t=e[i];i++)if(t.handler===n)return i;return-1}function u(e,n){return e.handleEvent?e.handleEvent(n):e(n)}function g(e,n){return{handler:e,isOnce:!!n}}var p="process"in e,E="WorlerLocation"in e,m="document"in e,y=!p&&"function"==typeof e.define&&e.define.amd,w=null,H="",W=0;if(m||E){var C=e.location;H=C.origin||C.protocol+"//"+C.hostname,w=e.document}n.prototype={constructor:n,on:t,off:i,ready:r,once:a,one:a,trigger:o,triggerSync:s,callHandlers:d,getEvent:l,handleEvent:c,createNewInstance:v};var O=new n;y?define([],function(){return O}):p?module.exports=O:e.simpleEventHandler=O}((this||0).self||global);